!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.koextensions=t()}}(function(){return function t(e,n,r){function a(o,l){if(!n[o]){if(!e[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return a(n?n:t)},u,u.exports,t,e,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(t,e,n){"use strict";var r=t("./kotools"),a={};a.colors=d3.scale.ordinal().range(["#1f77b4","#2ca02c","#d62728","#393b79","#ff7f0e","#8c564b","#843c39"]),a.getElementAndCheckData=function(t,e){var n=d3.select(t);return null===e||void 0===e||0===e.length?(t.innerHTML="No data available",null):(t.innerHTML="",n)},a.legendFont=function(t){return t>20?8:t>15?10:t>10?12:13},a.getLegendWidthAndFontSize=function(t){if(!t||0===t.length)return 0;var e=d3.max(t,function(t){return t.length}),n=a.legendFont(e),r=n+2;return{fontSize:n+"px",width:r+(n-3)*e,rectangle:r}},a.showStandardLegend=function(t,e,n,r,i){if(r){var o=a.getLegendWidthAndFontSize(e),l=t.append("svg").attr("width",o.width).selectAll("g").data(e).enter().append("g").attr("transform",function(t,e){return"translate(0,"+e*(o.rectangle+4)+")"});l.append("rect").attr("width",o.rectangle).attr("height",o.rectangle).style("fill",function(t){return n(t)}),l.append("text").attr("x",o.rectangle+4).attr("y",o.rectangle/2).attr("font-size",o.fontSize).attr("dy",".35em").text(function(t){return t})}},a.headerStyle=function(t){t.style("text-align","left").style("font-size","12px").style("font-family","sans-serif").style("margin-bottom","4px").style("color","#FFFFFF").style("font-weight","bold").style("clear","both").style("float","left")},a.valueStyle=function(t){t.style("text-align","left").style("font-size","12px").style("font-family","sans-serif").style("margin-bottom","4px").style("margin-left","6px").style("color","#FFFFFF").style("float","left")},a.showTooltip=function(t){d3.select("#toolTipBorder")[0]&&a.createTooltip();var e,n,i=d3.select("#toolTipBorder"),o=d3.select("#toolTip");o.html("");for(e in t)t.hasOwnProperty(e)&&(n=t[e],a.headerStyle(o.append("div").text(e)),n&&(r.isDate(n)?a.valueStyle(o.append("div").text(n.toFormattedString())):a.valueStyle(o.append("div").text(n))));i.transition().duration(200).style("opacity",".83"),i.style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY-75+"px")},a.hideTooltip=function(){var t=d3.select("#toolTipBorder");t.transition().duration(300).style("opacity","0")},a.createTooltip=function(){var t=d3.select("body").append("div");t.attr("id","toolTipBorder").style("position","absolute").style("opacity",0).style("background-color","#111111").style("border-radius","6px").style("padding","10px").style("padding-bottom","6px").append("div").attr("id","toolTip").style("z-index",1e5)},a.getDimensions=function(t,e){var n={};if(n.margin={top:t.top||20,right:t.right||50,bottom:t.bottom||30,left:t.left||50},n.width=t.width||200,n.height=t.height||100,n.yAxisWidth=40,t.yAxisLabel&&(n.yAxisWidth=80),t.xAxisTextAngle&&(n.margin.bottom=50*t.xAxisTextAngle/90+n.margin.bottom),n.legendWidth=0,t.legend&&(n.legendWidth=150),t.xAxisLabel&&(n.margin.bottom+=15),n.containerHeight=n.height+n.margin.top+n.margin.bottom,n.containerWidth=n.width+n.yAxisWidth+n.margin.left+n.margin.right,t.fillParentController&&(n.containerWidth=r.getWidth(e)-n.legendWidth-20,n.containerHeight=d3.max([r.getHeight(e),t.height])-30,n.height=n.containerHeight-(n.margin.top+n.margin.bottom),n.width=n.containerWidth-(n.yAxisWidth+n.margin.left+n.margin.right),n.fillParentController=!0),t.horizontalSlider){var a=30,i=60;t.xAxisTextAngle&&(a=60,i=80),n.sliderHeight=20,n.containerHeight=n.height+n.sliderHeight+a+i,n.sliderOffset=n.height+a}return n},a.appendContainer=function(t,e){var n=t.append("svg").attr("width",e.containerWidth).attr("height",e.containerHeight).append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")");return n},a.createXAxis=function(t,e,n,r){var i=d3.svg.axis().scale(n).orient("bottom");e.xFormat&&i.tickFormat(e.xFormat),e.tickValues&&i.tickValues(e.tickValues);var o=t.append("g").attr("class","x axis").attr("transform","translate(0,"+r.height+")").call(i);return a.xAxisStyle(o),a.rotateAxisText(o,e),e.xAxisLabel&&t.append("text").style("font-size","13").style("font-family","sans-serif").style("font-weight","bold").attr("class","x label").attr("text-anchor","end").attr("x",r.width/2+35).attr("y",r.height+r.margin.bottom).text(e.xAxisLabel),i},a.rotateAxisText=function(t,e){e.xAxisTextAngle&&t.selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate("+e.xAxisTextAngle+")").style("text-anchor","start")},a.yAxisStyle=function(t){t.select("path").style("display","none"),t.selectAll("line").style("shape-rendering","crispEdges").style("stroke","#000"),t.selectAll("line").style("stroke","#777").style("stroke-dasharray","2.2"),t.style("font-family","sans-serif"),t.style("font-size","13")},a.xAxisStyle=function(t){return t.select("path").style("display","none"),t.select("line").style("shape-rendering","crispEdges").style("stroke","#000"),t.selectAll("line").style("stroke","#000"),t.style("font-family","sans-serif"),t.style("font-size","13"),t},a.createYAxis=function(t,e,n,r){var i=d3.svg.axis().scale(n).tickSize(r.width).orient("right");e.yFormat&&i.tickFormat(e.yFormat);var o=t.append("g").attr("class","y axis").call(i);return a.yAxisStyle(o),e.yAxisLabel&&t.append("text").attr("class","y label").attr("text-anchor","end").attr("y",0).attr("dy",".75em").style("font-size","13").style("font-family","sans-serif").style("font-weight","bold").text(e.yAxisLabel).attr("transform","translate("+(r.width+r.yAxisWidth)+","+r.height/2+")rotate(-90)"),i},a.determineXScale=function(t,e,n){e||(e={allNumbers:!0,allDates:!0,min:Number.MAX_VALUE,max:Number.MIN_VALUE,xKeys:[]});var a=t.map(function(t){return r.isNumber(t)||(e.allNumbers=!1),r.isDate(t)||(e.allDates=!1),t<e.min&&(e.min=t),t>e.max&&(e.max=t),t});return e.xKeys?e.xKeys=e.xKeys.concat(a):e.xKeys=a,e.scaleType=e.allNumbers?"linear":e.allDates?"date":"ordinal",e.xFormat=e.allDates?r.getIdealDateFormat([e.min,e.max]):null,n.xFormat||(n.xFormat=e.xFormat),e},a.getXScaleForMultiLines=function(t,e){var n=null;return t.forEach(function(t){n=a.determineXScale(t.values.map(function(t){return t.x}),n,e)}),n},a.getYScaleDefForMultiline=function(t,e,n){var r=null;return t.forEach(function(t){var i=t.values;n&&(i=t.values.filter(function(t){return t.x>=n[0]&&t.x<=n[1]})),r=a.determineYScale(i.map(function(t){return t.y}),r,e)}),r},a.determineYScale=function(t,e,n){if(e||(e={min:Number.MAX_VALUE,max:Number.MIN_VALUE}),t.forEach(function(t){t<e.min&&(e.min=t),t>e.max&&(e.max=t)}),n.marginCoef){var r=-n.marginCoef;e.max=e.max>0?e.max*n.marginCoef:e.max*r,e.min=e.min<0?e.min*n.marginCoef:e.min*r}return e.min=n.yMin||e.min,e.max=n.yMax||e.max,e},a.getXScaleFromConfig=function(t,e){var n;if("linear"===t.scaleType)n=d3.scale.linear().range([0,e.width],.1),n.domain([t.min,t.max]);else if("ordinal"===t.scaleType)n=d3.scale.ordinal().rangeRoundBands([0,e.width],.1),n.domain(t.xKeys);else{if("date"!==t.scaleType)throw"invalid scale type";n=d3.time.scale().range([0,e.width],.1),n.domain([t.min,t.max]),n.ticks(10)}return n},a.xGetter=function(t,e){return function(n){if("ordinal"===t.scaleType)return e(n)+e.rangeBand()/2;if("date"===t.scaleType||"linear"===t.scaleType)return e(n);throw"invalid Scale Type"}},a.createVerticalLine=function(t,e,n){return t.append("line").attr("x1",e).attr("y1",0).attr("x2",e).attr("y2",n).attr("stroke-width",2).attr("stroke","black")},a.mouseCoordinates=function(t,e,n){var r=d3.mouse(t);return{x:r[0],y:r[1],rY:n.invert(r[1]),rX:e.invert(r[0])}},a.moveLine=function(t,e){var n=t.attr("x1"),r=e-n;t.attr("transform","translate("+r+",0)")},a.createMouseMoveListener=function(t,e,n){t.append("rect").attr("class","overlay").attr("width",e.width).attr("height",e.height).style("fill","none").style("pointer-events","all").on("mousemove",n)},a.createOrMoveVerticalLine=function(t,e,n,r){return t?(a.moveLine(t,r),t):a.createVerticalLine(e,r,n.height)},a.passOptions=function(t,e){return function(n){t(e,n)}},a.singlePointOver=function(t,e,n){var r={},i=e.xFormat?e.xFormat(n.x):n.x;r[i]="";var o=n.linename||"value";r[o]=n.y,a.showTooltip(r),d3.select(t).style("fill","black")},a.singlePointOut=function(t){d3.select(t).style("fill","white"),a.hideTooltip()},e.exports=a},{"./kotools":10}],2:[function(t,e,n){"use strict";var r=t("./../kotools"),a=t("./../charting");a.barChart=function(t,e,n,i){var o=a.getElementAndCheckData(e,t);if(o){var l={legend:!0,width:600,height:200,xUnitName:"x",itemName:"Item",xcoord:"x"};n=r.setDefaultOptions(l,n);var s=n.xcoord,u=[];t.map(function(t){var e=d3.keys(t).filter(function(t){return t!==s&&u.indexOf(t)<0});u=u.concat(e)});var c=a.colors.domain(u),d=a.getDimensions(n,o),f=t.map(function(t){return t[s]});a.determineXScale(f,null,n);var h=d3.scale.ordinal().rangeRoundBands([0,d.width],.3),g=d3.scale.linear().rangeRound([d.height,0]),p=[],y={};t.forEach(function(t){var e={x:t[s]},a=0,i=0,o=[];c.domain().forEach(function(l){if(r.isNumber(t[l])&&0!==t[l]&&null!==t[l]){var s=e.x;n.xFormat&&(s=n.xFormat(e.x));var u=t[l];n.yFormat&&(u=n.yFormat(t[l]));var c={name:l,val:t[l],x:e.x,xLabel:s,xUnitName:n.xUnitName,formattedValue:u};if(t[l]>0&&"stack"===n.style)c.y0=i,i+=t[l],c.y1=i;else if(t[l]<0&&"stack"===n.style){var d=a;a+=t[l],c.y0=a,c.y1=d}else t[l]>0&&"stack"!==n.style?(c.y0=0,c.y1=t[l]):t[l]<0&&"stack"!==n.style&&(c.y0=t[l],c.y1=0);o.push(c)}}),e.values=o,e.totalPositive=d3.max(e.values,function(t){return t.y1}),e.totalNegative=d3.min(e.values,function(t){return t.y0}),p.push(e),y[e.x]=e}),a.showStandardLegend(o,u,c,n,d);var m=a.appendContainer(o,d);h.domain(f),"stack"===n.style?g.domain([d3.min(p,function(t){return t.totalNegative}),d3.max(p,function(t){return t?t.totalPositive:0})]):g.domain([d3.min(p,function(t){return d3.min(t.values,function(t){return t.val<0?t.val:0})}),d3.max(p,function(t){return d3.max(t.values,function(t){return t.val})})]);var x=d3.scale.ordinal();x.domain(u).rangeRoundBands([0,h.rangeBand()]),a.createXAxis(m,n,h,d),a.createYAxis(m,n,g,d);var v=function(t){var e=y[t.x];d3.select(this).style("opacity",1);var i={};i[t.xLabel]="",i[t.name]=t.formattedValue,0===e.totalNegative&&"stack"===n.style&&(i[t.name]+=" ("+r.toPercent(t.val/e.totalPositive)+")"),a.showTooltip(i)},b=function(){d3.select(this).style("stroke","none"),d3.select(this).style("opacity",.9),a.hideTooltip()},w=m.selectAll(".xVal").data(p).enter().append("g").attr("class","g").attr("transform",function(t){return"translate("+h(t.x)+",0)"}),k=w.selectAll("rect").data(function(t){return t.values}).enter().append("rect");if("stack"===n.style?k.attr("width",h.rangeBand()):k.attr("width",x.rangeBand()).attr("x",function(t){return x(t.name)}),k.attr("y",function(t){return g(t.y1)}).attr("height",function(t){var e=Math.abs(g(t.y0)-g(t.y1));return e}).on("mouseover",v).on("mouseout",b).style("opacity",.9).style("cursor","pointer").style("fill",function(t){return c(t.name)}),i&&0!==i.length){var A=d3.scale.linear().range([d.height,0]),F=d3.svg.line().interpolate("linear").x(function(t){return h(t.x)+h.rangeBand()/2}).y(function(t){return A(t.y)});n.sameScaleLinesAndBars?A.domain(g.domain()):A.domain([0,d3.max(i,function(t){return t.y})]);var S=d3.svg.axis().scale(A).orient("left"),T=m.append("g").call(S);a.yAxisStyle(T),m.append("path").attr("d",F(i)).style("stroke","blue").style("stroke-width",2).style("fill","none");var D=m.selectAll("circle").data(i).enter().append("circle");D.attr("cx",function(t){return h(t.x)+h.rangeBand()/2}).attr("cy",function(t){return A(t.y)}).attr("r",function(){return 4}).style("fill","white").attr("r",function(){return 3}).style("fill","white").style("stroke-width","1").style("stroke","black").style("cursor","pointer").on("mouseover",function(t){a.singlePointOver(this,n,t)}).on("click",function(t){a.singlePointOver(this,n,t)}).on("mouseout",function(t){a.singlePointOut(this)})}}}},{"./../charting":1,"./../kotools":10}],3:[function(t,e,n){"use strict";var r=t("./../kotools"),a=t("./../charting");a.bubbleChart=function(t,e,n){var i=a.getElementAndCheckData(e,t);if(i){var o={legend:!0,width:500,height:200,maxBubbleSize:50,bubbleHorizontal:function(t){return t.x},bubbleVertical:function(t){return t.y},bubbleSize:function(t){return t.size},bubbleColor:function(t){return t.color},horizontalLabel:"x",verticalLabel:"y",sizeLabel:"size",typeLabel:"type",xAxisLabel:!1,yAxisLabel:!1,xAxisTextAngle:null};n=r.setDefaultOptions(o,n);var l=a.getDimensions(n,i),s=t.map(n.bubbleHorizontal),u=t.map(n.bubbleVertical),c=t.map(n.bubbleSize);c.sort(d3.ascending);var d=d3.max(c),f=d3.min(c),h=a.determineXScale(s,null,n),g=a.getXScaleFromConfig(h,l),p=a.determineYScale(u,null,n),y=d3.scale.linear().domain([p.min,p.max]).range([l.height,0]),m=d3.scale.pow().exponent(.4).domain([f,d]).range([1,n.maxBubbleSize]).clamp(!0),x=r.distinct(t,n.bubbleColor),v=a.colors.domain(x);a.showStandardLegend(i,x,v,n,l);var b=a.appendContainer(i,l);a.createXAxis(b,n,g,l),a.createYAxis(b,n,y,l);var w=function(){d3.select(this).style("opacity",.8),a.hideTooltip()},k=function(t){d3.select(this).style("opacity",1);var e={};e[n.typeLabel]=n.bubbleColor(t),e[n.sizeLabel]=n.bubbleSize(t),e[n.verticalLabel]=n.bubbleVertical(t),e[n.horizontalLabel]=n.bubbleHorizontal(t),a.showTooltip(e)},A=a.xGetter(h,g);b.append("g").attr("class","dots").selectAll(".dot").data(t).enter().append("circle").attr("class","dot").style("fill",function(t){return v(n.bubbleColor(t))}).style("opacity",.8).attr("cx",function(t){return A(n.bubbleHorizontal(t))}).attr("cy",function(t){return y(n.bubbleVertical(t))}).attr("r",function(t){return m(n.bubbleSize(t))}).style("cursor","pointer").on("mouseover",k).on("click",k).on("mouseout",w)}}},{"./../charting":1,"./../kotools":10}],4:[function(t,e,n){"use strict";var r=t("./../kotools"),a=t("./../charting");a.chordChart=function(t,e,n){var i=a.getElementAndCheckData(e,t);if(i){var o={width:800,height:800,fillParentController:!1,chordMouseOver:null};n=r.setDefaultOptions(o,n);var l=a.getDimensions(n,i),s=Math.min(l.width,l.height)/2-100,u=s-24,c=function(e){return n.hideNames?e.index+1:t.names[e.index]},d=a.colors,f=d3.svg.arc().innerRadius(u).outerRadius(s),h=d3.layout.chord().padding(.04),g=d3.svg.chord().radius(u),p=i.append("svg").attr("width",l.width).attr("height",l.height).append("g").attr("id","circle").attr("transform","translate("+l.width/2+","+l.height/2+")"),y=function(t){return n.chordFormat&&(t=n.chordFormat(t)),t},m=function(e,n){var r=t.names[e.source.index],i=t.names[e.source.subindex],o=r+" - "+i,l={},s=y(e.source.value);l[o]=s,p.selectAll(".chord").filter(function(t,e){return n!==e}).transition().style("opacity",.1),a.showTooltip(l)},x=function(t,e){p.selectAll(".chord").transition().style("opacity",1),a.hideTooltip()},v=function(t){return function(e,n){p.selectAll(".chord").filter(function(t){return t.target.index!==n&&t.source.index!==n}).transition().style("opacity",t);var r={},i=y(e.value);r[c(e)]=i,a.showTooltip(r)}};h.matrix(t.matrix);var b=p.selectAll(".group").data(h.groups).enter().append("g").attr("class","group");b.append("path").attr("id",function(t,e){return"group"+e}).attr("d",f).style("fill",function(t,e){return d(e)}).on("mouseover",v(.1)).on("mouseout",v(1)),b.append("text").each(function(t){t.angle=(t.startAngle+t.endAngle)/2}).attr("dy",".35em").attr("transform",function(t){return"rotate("+(180*t.angle/Math.PI-90)+")translate("+(u+26)+")"+(t.angle>Math.PI?"rotate(180)":"")}).style("text-anchor",function(t){return t.angle>Math.PI?"end":null}).attr("font-family","Open Sans, sans-serif").style("font-size","13px").text(c),p.selectAll(".chord").data(h.chords).enter().append("path").attr("class","chord").style("fill",function(t){return d(t.source.index)}).style("cursor","pointer").attr("d",g).on("mouseover",m).on("mouseout",x).on("click",m)}}},{"./../charting":1,"./../kotools":10}],5:[function(t,e,n){"use strict";var r=t("./../kotools"),a=t("./../charting");a.histogram=function(t,e,n){var i={bins:80,width:500,fillParentController:!1,histogramType:"frequency",rangeRounding:2},o=a.getElementAndCheckData(e,t);if(null!==o){n=r.setDefaultOptions(i,n);var l=a.getDimensions(n,o),s=d3.layout.histogram().frequency("frequency"===n.histogramType).bins(n.bins)(t),u=r.isValidNumber(n.min)?n.min:d3.min(s,function(t){return t.x}),c=d3.scale.linear().domain([u,d3.max(s,function(t){return t.x})]).range([0,l.width-10]),d=c(u+s[0].dx)-1,f=d3.scale.linear().domain([0,d3.max(s,function(t){return t.y})]).range([l.height,0]),h=a.appendContainer(o,l),g=h.selectAll(".bar").data(s).enter().append("g").attr("class","bar").attr("transform",function(t){return"translate("+c(t.x)+","+f(t.y)+")"}),p=function(t){d3.select(this).style("opacity",1);var e="frequency"==n.histogramType?"count":"probability",r={};r[e]=t.y,r.range=t.x.toFixed(n.rangeRounding)+" - "+(t.x+t.dx).toFixed(n.rangeRounding),a.showTooltip(r)},y=function(){a.hideTooltip(),d3.select(this).style("opacity",.8)};g.append("rect").attr("x",1).attr("width",d).attr("height",function(t){return l.height-f(t.y)}).attr("fill","#1f77b4").attr("opacity",.8).style("cursor","pointer").on("mouseover",p).on("mouseout",y),a.createXAxis(h,n,c,l),a.createYAxis(h,n,f,l);d3.svg.line().interpolate("linear").x(function(t){return c(t.x)+c.rangeBand()/2}).y(function(t){return f(t.y)});if(n.showProbabilityDistribution){var m=r.isValidNumber(n.min)?n.min:d3.min(t),x=r.isValidNumber(n.max)?n.max:d3.max(t),v=d3.sum(t),b=(x-m)/500,w=v/t.length;"median"==n.expected&&(w=d3.median(t));var k=0,A=[];t.forEach(function(t){var e=t-w;A.push(Math.abs(e)),k+=e*e}),k=n.useMAD?d3.median(A):k/t.length-1;var F=0,S=[];for(F=m;F<x;F+=b){var T=-(F-w)*(F-w)/(2*k),D=1/Math.sqrt(2*Math.PI*k)*Math.pow(Math.E,T);S.push({x:F,y:D})}var f=d3.scale.linear().range([l.height,0]);f.domain([d3.min(S,function(t){return t.y}),d3.max(S,function(t){return t.y})]);var u=d3.min(S,function(t){return t.x}),M=d3.max(S,function(t){return t.x});c.domain([u,M]);var C=d3.svg.line().interpolate("linear").x(function(t){return c(t.x)}).y(function(t){return f(t.y)});h.append("path").attr("class","line").attr("d",C(S)).style("stroke-width",2).style("stroke","red").style("fill","none"),n.showOutliers&&t.forEach(function(t){var e=Math.abs(t-w);e>k*n.tolerance&&h.append("circle").attr("cx",c(t)+2).attr("cy",l.height).attr("r",4).attr("fill","green").attr("opacity",.8)})}}}},{"./../charting":1,"./../kotools":10}],6:[function(t,e,n){"use strict";var r=t("./../koTools"),a=t("./../charting");a.lineChart=function(t,e,n){var i=a.getElementAndCheckData(e,t);if(i){var o={legend:!0,width:200,height:200,horizontalLabel:"x",verticalLabel:"y",showDataPoints:!0,verticalCursorLine:!1,xAxisLabel:!1,yAxisLabel:!1,xAxisTextAngle:null};n=r.setDefaultOptions(o,n),t.forEach(function(t){if(!t.values)throw"Each line needs to have values property containing tuples of x and y values";t.values.sort(function(t,e){return d3.ascending(t.x,e.x)}),t.values.forEach(function(e){e.linename=t.linename})});var l=t.map(function(t){return t.linename}),s=null,u=d3.scale.category20();u.domain(l);var c=function(t){return t.color||u(t.linename)},d=a.getDimensions(n,i,l),f=d3.scale.linear().range([d.height,0]),h=a.getXScaleForMultiLines(t,n),g=a.getXScaleFromConfig(h,d),p=function(t){return a.xGetter(h,g)(t.x)},y=a.getYScaleDefForMultiline(t,n);f.domain([y.min,y.max]);var m=d3.svg.line().interpolate("linear").x(p).y(function(t){return f(t.y)}),x=a.appendContainer(i,d);if(a.showStandardLegend(i,l,u,n,d),n.xTick){var v=h.xKeys.filter(function(t){return t%n.xTick===0});n.tickValues=v}var b=a.createXAxis(x,n,g,d),w=a.createYAxis(x,n,f,d),k=function(t){var e={};e[t.linename]="",a.showTooltip(e)},A=x.selectAll(".lines").data(t).enter().append("path").attr("class","line").attr("d",function(t){return m(t.values)}).style("stroke-width",function(t){return t.width||2}).style("stroke",function(t){return c(t)}).style("fill","none").on("mouseover",k).on("mouseout",a.hideTooltip).attr("clip-path","url(#clip)");if(n.showDataPoints){var F=1===t.length?t[0].values:t.reduce(function(t,e){return t.values?t.values.concat(e.values):t.concat(e.values)});s=x.selectAll(".point").data(F).enter().append("circle").attr("cx",p).attr("cy",function(t){return f(t.y)}).attr("r",function(){return 3}).style("fill","white").style("stroke-width","1").style("stroke","black").style("cursor","pointer").on("mouseover",function(t){a.singlePointOver(this,n,t)}).on("click",function(t){a.singlePointOver(this,n,t)}).on("mouseout",function(){a.singlePointOut(this)}).attr("clip-path","url(#clip)")}if(n.horizontalSlider){var S=x.append("g").attr("transform","translate(0,"+d.sliderOffset+")").attr("class","context"),T=a.getXScaleFromConfig(h,d),D=g.ticks(),M=D[2],C=D[7],L=d3.svg.brush().x(T).extent([M,C]),O=function(){var e=L.empty()?T.domain():L.extent();g.domain(e);var r=x.select(".x.axis");r.transition().call(b),a.rotateAxisText(r,n),a.xAxisStyle(r),y=a.getYScaleDefForMultiline(t,n,e),f.domain([y.min,y.max]),r=x.select(".y.axis"),r.transition().call(w),a.yAxisStyle(r),A.transition().attr("d",function(t){return m(t.values)}),s&&s.transition().attr("cx",p).attr("cy",function(t){return f(t.y)})};L.on("brush",O);var N=d3.svg.axis().scale(T).tickFormat(n.xFormat).orient("bottom"),H=S.append("g").attr("class","x sliderAxis").attr("transform","translate(0,"+d.sliderHeight+")").call(N);a.xAxisStyle(H),a.rotateAxisText(H,n),x.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",d.width).attr("height",d.height);var z=d3.svg.area().interpolate("monotone").x(function(t){return T(t.x)}).y0(d.sliderHeight).y1(0);S.append("path").attr("class","area").attr("d",z(t[0].values)).attr("fill","#F1F1F2"),S.append("g").attr("class","x brush").call(L).selectAll("rect").attr("height",d.sliderHeight).attr("fill","#1f77b4").attr("rx","5")}}}},{"./../charting":1,"./../koTools":9}],7:[function(t,e,n){"use strict";var r=t("./../koTools"),a=t("./../charting");a.pieChart=function(t,e,n){var i=a.getElementAndCheckData(e,t);if(i){var o={legend:!0,width:200,height:150,left:3,right:3};if(n=r.setDefaultOptions(o,n),t=t.filter(function(t){return t.y>0}),0!==t.length){var l=n.colors||a.colors,s=t.map(function(t){return t.x});n.colors||l.domain(s);var u=a.getDimensions(n,i),c=Math.min(u.width,u.height)/2-3,d=d3.layout.pie(),f=d3.svg.arc().outerRadius(c),h=c-30,g=d3.svg.arc().outerRadius(h).innerRadius(h);d.value(function(t){return t.y});var p=d3.sum(t,function(t){return t.y});a.showStandardLegend(i,s,l,n,u);var y=a.appendContainer(i,u);y.data([t]);var m=y.selectAll("g.arc").data(d).enter().append("g").attr("class","arc").attr("transform","translate("+c+","+c+")"),x=function(t){d3.select(this).style("stroke","white"),d3.select(this).style("opacity",1);var e={},n=t.formatted+" ("+r.toPercent(t.percentage)+")";e[t.data.x]=n,a.showTooltip(e)},v=function(){d3.select(this).style("opacity",.9),a.hideTooltip()};m.append("path").attr("d",f).style("fill",function(t){return l(t.data.x)}).style("stroke-width",2).style("stroke","white").on("mouseover",x).on("mouseout",v).style("cursor","pointer").style("opacity",.9).each(function(t){t.percentage=t.data.y/p,t.formatted=n.yFormat?n.yFormat(t.data.y):t.data.y}),m.append("text").attr("transform",function(t){return"translate("+g.centroid(t)+")"}).style("font-family","sans-serif").style("font-size",12).style("fill","#FFFFFF").style("font-weight","bold").style("text-anchor","middle").text(function(t){return(100*t.percentage).toCurrencyString("%",1)})}}}},{"./../charting":1,"./../koTools":9}],8:[function(t,e,n){"use strict";function r(){function t(t,e){null!=t.val&&(null!=t.transf&&(t.val=t.transf(t.val)),a.isNumber(t.val)?e.innerHTML=t.val.toCurrencyString(t.currency,t.rounding):a.isDate(t.val)?e.innerHTML=t.val.toFormattedString():e.innerHTML=t.val)}function e(t){var e={currency:n(t.currency),val:n(t.formattedValue),transf:t.transformation,rounding:n(t.rounding)};return e}function n(t){return null!=t&&"function"==typeof t&&(t=t()),t}var r=this;r.tools=a,r.charting=i,r.registerExtensions=function(){return"undefined"==typeof ko?void console.log("Knockout was not found, using standalon KoExtensions for charting"):(ko.bindingHandlers.datepicker={init:function(t,e,n){var r=n().datepickerOptions||{};$(t).datepicker(r),ko.utils.registerEventHandler(t,"changeDate",function(t){var n=e();ko.isObservable(n)&&n(t.date)})},update:function(t,e){var n=$(t).data("datepicker");if(null!=n){var r=ko.utils.unwrapObservable(e());if(a.isString(r)&&(r=new Date(r)),!a.isValidDate(r))return;n.setDates(r)}}},ko.bindingHandlers.linechart={update:function(t,e,n){var r=n().chartOptions,a=n().linechart();i.lineChart(a,t,r)}},ko.bindingHandlers.piechart={update:function(t,e,n){var r=n().piechart(),a=n().chartOptions;i.pieChart(r,t,a)}},ko.bindingHandlers.barchart={update:function(t,e,n){var r=ko.unwrap(e()),a=ko.unwrap(n().chartOptions),o=ko.unwrap(n().line);i.barChart(r,t,a,o)}},ko.bindingHandlers.chordChart={update:function(t,e,n){var r=n().chordChart(),a=n().chartOptions;i.chordChart(r,t,a)}},ko.bindingHandlers.histogram={update:function(t,e,n){var r=ko.unwrap(e()),a=ko.unwrap(n().chartOptions);i.histogram(r,t,a)}},ko.bindingHandlers.scatterplot={update:function(t,e,n){var r=ko.unwrap(e()),a=ko.unwrap(n().chartOptions);i.scatterPlot(r,t,a)}},ko.bindingHandlers.bubblechart={update:function(t,e,n){var r=ko.unwrap(e()),a=ko.unwrap(n().chartOptions);i.bubbleChart(r,t,a)}},ko.bindingHandlers.formattedValue={update:function(n,r,a){var i=e(a());t(i,n)}},void(ko.bindingHandlers.progress={init:function(t,e,n,r,a){var i=e()();null==i&&(i=0),t.style.width=i+"%",t.style.display="none",t.style.display="block"},update:function(t,e,n){var r=e()();null==r&&(r=0),t.style.width=r+"%"}}))}}var a=t("./kotools"),i=t("./charting");t("./charts/piechart"),t("./charts/barchart"),t("./charts/linechart"),t("./charts/chordchart"),t("./charts/bubblechart"),t("./charts/histogramchart");var o=new r;o.registerExtensions(),e.exports=o},{"./charting":1,"./charts/barchart":2,"./charts/bubblechart":3,"./charts/chordchart":4,"./charts/histogramchart":5,"./charts/linechart":6,"./charts/piechart":7,"./kotools":10}],9:[function(t,e,n){"use strict";function r(){var t=this,e=new Date;t.currentYear=e.getFullYear(),t.currentMonth=e.getMonth(),t.isEmpty=function(t){return!t||0===t.length},Date.prototype.toFormattedString=function(){var t=this.getDate(),e=this.getMonth()+1,n=this.getFullYear();return t+"/"+e+"/"+n},Array.prototype.setOrAdd=function(t,e,n){null!==this[t]&&void 0!==this[t]||(this[t]=[]),null===this[t][e]||isNaN(this[t][e])?this[t][e]=n:this[t][e]+=n},Array.prototype.set=function(t,e,n){this[t]||(this[t]=[]),this[t][e]=n},Date.prototype.addDays=function(t){var e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e},t.getQuarter=function(t){return null!==t.Year&&null!==t.Quarter?"Q"+t.Quarter+t.Year:null},t.paddy=function(t,e,n){var r="undefined"!==n?n:"0",a=[1+e].join(r);return(a+t).slice(-a.length)},t.getMonth=function(e){return null!==e.Year&&null!==e.Month?String(e.Year)+t.paddy(e.Month,2).toString():null},t.monthsComparer=function(e,n){if(t.isString(e)){var r=parseInt(e.substring(0,4),10),a=parseInt(e.substring(4,e.length),10),i=parseInt(n.substring(0,4),10),o=parseInt(n.substring(4,n.length),10);return r===i?d3.ascending(a,o):d3.ascending(r,i)}return d3.ascending(e,n)},t.monthsIncrementer=function(t){var e=parseInt(t.substring(0,4),10),n=parseInt(t.substring(4,t.length),10);12===n?(n=1,e++):n++;var r=e.toString(),a=n.toString();return r+(a[1]?a:"0"+a[0])},t.quartersComparer=function(t,e){var n=t.substring(1,2),r=t.substring(2,6),a=e.substring(1,2),i=e.substring(2,6);return r===i?d3.ascending(n,a):d3.ascending(r,i)};var n=["January","February","March","April","May","June","July","August","September","October","November","December"];t.getYearAndMonthLabel=function(e){if(!t.isString(e))return"";var r=n[parseInt(e.substring(4,e.length),10)-1];return r},t.getProperty=function(t,e){return"function"==typeof t?t(e):e[t]},t.getWidth=function(e){return e.clientWidth?e.clientWidth:Array.isArray(e)&&e.length>0?t.getWidth(e[0]):null},t.getHeight=function(e){return e.clientHeight&&0!==e.clientHeight?e.clientHeight:Array.isArray(e)&&e.length>0?t.getHeight(e[0]):null!==e.parentElement?t.getHeight(e.parentElement):null},t.find=function(t,e){var n=0;for(n=0;n<t.length;n++)if(e(t[n]))return t[n];return null},t.isString=function(t){return"string"==typeof t},t.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},t.isValidNumber=function(t){return null!==t&&!isNaN(t)},t.isDate=function(t){return"[object Date]"===Object.prototype.toString.call(t)},Number.prototype.formatMoney=function(t,e,n){var r=this;t=isNaN(t=Math.abs(t))?2:t,e=void 0===e?".":e,n=void 0===n?",":n;var a=r<0?"-":"",i=parseInt(r=Math.abs(+r||0).toFixed(t),10)+"",o=(o=i.length)>3?o%3:0;return a+(o?i.substr(0,o)+n:"")+i.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+n)+(t?e+Math.abs(r-i).toFixed(t).slice(2):"")},t.parseDate=function(t){if(t instanceof Date)return t;var e=t.indexOf(" ");if(e!==-1){t=t.substring(0,e);var n="/",r=[];if(t.indexOf("-")!==-1){if(n="-",r=t.split(n),3===r.length)return new Date(r[0],r[1]-1,r[2]);if(t.indexOf("/")!==-1)return new Date(r[2],r[0]-1,r[1])}}return new Date(Date.parse(t))},t.isValidDate=function(e){return!!t.isDate(e)&&!isNaN(e.getTime())},t.compare=function(t,e){for(var n in t)if(t[n]!==e[n])return!1;return!0},t.toLength=function(t,e){if(t.length>=e)return t.substring(0,e);for(var n="",r=0;r<e;r++)n+=t[r%t.length];return n},Number.prototype.toCurrencyString=function(t,e){var n=this.toFixed(e).replace(/(\d)(?=(\d{3})+\b)/g,"$1 ");return null!=t&&(n+=" "+t),n},t.toPercent=function(t){return null===t?0:(100*t).toFixed(1)+" %"},Object.size=function(t){var e,n=0;for(e in t)t.hasOwnProperty(e)&&n++;return n};Object.prototype.toString;String.prototype.endsWith=function(t){return this.indexOf(t,this.length-t.length)!==-1},t.diff=function(t,e){return t.filter(function(t){return e.indexOf(t)<0})},t.tryConvertToNumber=function(t){var e=parseInt(t),n=parseFloat(t),r=null!=e?e:null!=n?n:t;return r},t.toBoolean=function(t){if(null==t)return!1;switch(t.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(t)}},t.dateToFrenchString=function(t){var e=t.getMonth()+1;return t.getDate()+"/"+e+"/"+t.getFullYear()},t.dateToUSString=function(t){var e=t.getMonth()+1;return e+"/"+t.getDate()+"/"+t.getFullYear()},t.getYearAndMonth=function(t){var e=t.getFullYear().toString(),n=(t.getMonth()+1).toString();return e+(n[1]?n:"0"+n[0])},t.splitMonthAndYear=function(e){return{year:t.tryConvertToNumber(e.substring(0,4)),month:t.tryConvertToNumber(e.substring(4,6))}},t.distinct=function(t,e){var n=t.map(e);return n.filter(function(t,e){return n.indexOf(t)==e})},t.convertSeriesToXYPairs=function(t){for(var e=[],n=0;n<t.length;n++)e.push({x:n,y:t[n]});return e},t.convertAllSeriesToXYPairs=function(e){if(null==e)return null;for(var n=0;n<e.length;n++)null!=e[n]&&null!=e[n].values&&t.isNumber(e[n].values[0])&&(e[n].values=t.convertSeriesToXYPairs(e[n].values));return e},t.setDefaultOptions=function(t,e){e=e||{};for(var n in t)e[n]=null!=e[n]?e[n]:t[n];return e},t.getIdealDateFormat=function(t){var e=t[0],n=t[1],r=864e5,a=Math.round(Math.abs((n.getTime()-e.getTime())/r));if(a>5)return function(t){var e=t.toFormattedString();return e};var i=Math.abs(n-e)/36e5;return i>2?function(t){return t.getHours()+":"+t.getMinutes()}:function(t){return t.getMinutes()+":"+t.getSeconds()}}}e.exports=new r;
},{}],10:[function(t,e,n){e.exports=t(9)},{}]},{},[8])(8)});